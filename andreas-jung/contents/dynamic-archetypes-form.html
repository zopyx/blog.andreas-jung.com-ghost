
    <html lang="en">
  
<!-- Mirrored from blog.zopyx.com/andreas-jung/contents/dynamic-archetypes-form by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 21 Sep 2020 14:23:23 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<base  />

    <meta charset="utf-8">
    <title> Dynamic Archetypes forms - Andreas Jung </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="The company for Zope, Plone, Python, MongoDB and Electronic Publishing">
    <meta name="author" content="ZOPYX, Andreas Jung, Tuebingen, Germany">

    <link href="dynamic-archetypes-form/assets/css/bootstrap.css" rel="stylesheet">

    <style>
      body {
        padding-top: 100px; /* 60px to make the container go all the way to the bottom of the topbar */
      }
    </style>
    <link rel="stylesheet" href="https://blog.zopyx.com/assets/css/font-awesome.css">

    <!-- fonts -->
    <link href="https://fonts.googleapis.com/css?family=Droid+Sans:400,700" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700" rel="stylesheet" type="text/css">

    <link rel="stylesheet/less" type="text/css" href="https://blog.zopyx.com/assets/less/bootstrap.less" />
    <script type="text/javascript" src="https://blog.zopyx.com/assets/js/less-1.3.1.min.js"></script>

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
      <![endif]-->
    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="dynamic-archetypes-form/assets/ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" src="https://blog.zopyx.com/assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" src="https://blog.zopyx.com/assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" src="https://blog.zopyx.com/assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" src="https://blog.zopyx.com/assets/ico/apple-touch-icon-57-precomposed.png">

    <link rel="stylesheet" href="https://blog.zopyx.com/assets/css/base.css">
    <link rel="stylesheet" href="https://blog.zopyx.com/bxslider/jquery.bxslider.css">


    <!-- Plone compatibility -->
    
    
  </head>

  <body data-spy="scroll" data-target=".sidebar-nav" class="section-andreas-jung context-dynamic-archetypes-form portal-type-news-item">

    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          
            
            <a class="brand" style="color: white" href="../contents.html">
              <h1>Blog of Andreas Jung</h1>
            </a>
          
          
          
          
           <form id="global-nav-search" class="navbar-search pull-right" action="https://blog.zopyx.com/andreas-jung/search">
            
            <input type="text" class="search-query" placeholder="Search" name="SearchableText" />
           </form>
        </div>
      </div>
    </div>
     <!-- /keyvisual -->
    <article>
      <section>

        <!-- main -->
        <div class="container container-main">
            
            <div class="row-fluid">
                <div></div>
            </div>
            <div class="row-fluid">
                <div class="span8">
                    
                    <div id="content">
                      

                        
                            
    <span class="label">Aug 14, 2006</span>

                            
                                
                                
            
                <h1 id="parent-fieldname-title" class="documentFirstHeading">
                    Dynamic Archetypes forms
                </h1>
            
            
        
                            

                            
                                <div class="documentDescription">This blog entry gives a short introduction about making static Archetypes forms more dynamic</div> 
                            

                            <div id="content-core">
                                
    

        
        

        

        <div id="parent-fieldname-text" class="plain">
            <div><p>Autogenerated Archetypes forms (generated through the base_edit view) are in general boring static. Often you have the use-case to make forms more dynamic. What means dynamic? Dependent on the value of a particular form element you might be interested e.g. to show or hide other elements of the form. In a recent project we had the case where the user could choose a particular publication mode (daily, weekly, monthly, bi-monthly) for a given document. The widgets for the different publication modes were somewhat complex and bit large since a single widget did consist of serveral other checkboxes. select elements and input fields. It was the customer's wish to present only only one publication widget  that matched the value of the particular publication mode. <br /></p><h3>So how to approach this problem?</h3><p>The solution is pretty easy: Javascript + CSS. Using the <a href="http://prototype.conio.net/">prototype.js</a> Javascript library (a good documentation can be found <a href="http://www.sergiopereira.com/articles/prototype.js.html">here</a>) and the Plone Javascript resource registry it was easy to add an event handler to the select element that controls the publication mode:<br /></p><pre>  Event.observe(select_id, 'click', observer);</pre>This tells the browser to call the method <b>observer()</b> for every change on the element with the ID <b>select_id. </b>The implementation of the observer() method basically looks like this:<br /><br /><pre>function observer() {<br />    var v = $F(select_id);<br /><br />    if (v=='weekly') <br />       show_weekly_control()<br /><br />    if (v=='monthly')<br />       show_monthly_control()<br />    ....<br />}<br /></pre><p>So everytime you cange the value of the select element the actual value of select element ($F() is a shortcut method (provided by prototype.js)  to obtain the value of a form element independent of its type) is stored in the variable <b>v. </b>For every possible value of <b>v </b>there is a dedicated method that controls the visibility of other form elements:</p><pre>function show_weekly_control() {<br />    show_element('archetypes-fieldname-control_weekly');<br />    hide_element('archetypes-fieldname-control_monthly');<br />}<br /><br />function show_monthly_control() {<br />    hide_element('archetypes-fieldname-control_weekly');<br />    show_element('archetypes-fieldname-control_monthly');<br />}<br /><br />function show_element(id) {<br />    if ($(id))<br />        $(id).style.display = 'block';<br />}<br /><br />function hide_element(id) {<br />    if ($(id))<br />        $(id).style.display = 'none';<br />}<br /></pre><p>The <b>archetype-fieldname-XXXXX </b>IDs are autogenerated IDs (by Archetypes) for every field of a schema.<br /></p>Using this approach we are able to hide and show form elements for general Archetypes forms without hacking any Archetypes or Plone code. I know that this not a complete how-to but it shall point you in the right direction to make more out of your boring Archetype forms.<br /></div>
        </div>


         
    

                            </div>
                        

                      
                    </div>
                  
                </div>
                <!-- right slot -->
                <div class="span4">
                    <div></div>
                    
                        
                    
                    <div></div>
                </div>
          </div>
        </div>

        <!-- main front-page -->
        
      <div class="footer-push"></div>
    
      </section>
    </article>
    <!-- ----------------------------------- /Footer -->
    

<!-- Matomo -->
<script type="text/javascript">
  var _paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="http://matomo.zopyx.com/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '8']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->


    <script type="text/javascript" src="dynamic-archetypes-form/assets/js/jquery.js"></script>
    <script type="text/javascript" src="dynamic-archetypes-form/assets/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://blog.zopyx.com/jquerytools/jquery.tools.min.js"></script>
    <script type="text/javascript" src="https://blog.zopyx.com/readmore/jquery.readmore.min.js"></script>
    <script type="text/javascript" src="https://blog.zopyx.com/isotope/jquery.isotope.js"></script>
    <script type="text/javascript" src="https://blog.zopyx.com/hyphenator/hyphenate.js"></script>
    <script type="text/javascript" src="https://blog.zopyx.com/cycle/jquery.cycle.js"></script>
    <script type="text/javascript" src="https://blog.zopyx.com/bxslider/jquery.bxslider.min.js"></script>


    <script type="text/javascript">
        $('.carousel').carousel({interval: 6000});
        $('.readmore').readmore({substr_len: 250});
        $('input[type="submit"]').addClass('btn btn-success');
        $('input[type="reset"]').addClass('btn btn-danger');
        if ($('body').width() > 640) {
            $('.image-cycle').cycle({fx: 'fadeZoom', speed: 1000, timeout: 5000});
            $('.bxslider').bxSlider({randomStart: true,speed: 1000, pause:4000, auto: true});
            $('.bxslider1').bxSlider({randomStart: true,speed: 1000, pause:4000, auto: true});
            $('.bxslider-pp').bxSlider({randomStart: false, mode: 'fade', speed: 1000, pause:7000, auto: true, infiniteLoop: true, controls: false});
        }  
        /*
        Hyphenator.config({
            displaytogglebox : true,
            minwordlength : 4,
            defaultlanguage: 'de',
            classname: 'content'
        });
        Hyphenator.run();
        */

        // Resize iframe.fluid (Slideshare, YouTube integration)
        $(function() {
            var $slides= $('iframe.fluid');
            $slides.each(function() {
                $(this)
                    .data('aspectRatio', this.height / this.width)
                    .removeAttr('height')
                    .removeAttr('width');
            });
            // When the window is resized
            // (You'll probably want to debounce this)
            $(window).resize(function() {

                $fluidEl = $(".media-item");
                var newWidth = $fluidEl.width() *0.9;
                
                // Resize all videos according to their own aspect ratio
                $slides.each(function() {

                    var $el = $(this);
                    $el.width(newWidth)
                       .height(newWidth * $el.data('aspectRatio'));

                });
            // Kick off one resize to fix all videos on page load
            }).resize();
        });

    </script>

    <!-- Jira feedback collector -->
    
    


  </body>

<!-- Mirrored from blog.zopyx.com/andreas-jung/contents/dynamic-archetypes-form by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 21 Sep 2020 14:23:26 GMT -->
</html>


